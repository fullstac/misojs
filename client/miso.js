(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var m=require("mithril");module.exports={isServer:function(){return!1},readyBinder:function(){var r=[];return{bind:function(n){r.push(n)},ready:function(){for(var n=0;n<r.length;n+=1)r[n]()}}},getParam:function(r){return m.route.param(r)}};
},{"mithril":6}],2:[function(require,module,exports){
var m=require("mithril");module.exports=function(){var r=function(r){var o,e={};for(o in r)r.hasOwnProperty(o)&&"isValid"!==o&&(e[o]="function"==typeof r[o]?r[o]():r[o]);return e};return{load:function(r,o){if(!r)throw new Error("no type provided to load model");if(!o)throw new Error("no id provided to load model");return m.request({method:"GET",url:"/user.json"})},save:function(o,e){var i,n=e.isValid?e.isValid():!0;return n===!0?(i=r(e),m.request({method:"POST",url:"/api/"+o,data:i})):void console.log("Model invalid",n)}}};
},{"mithril":6}],3:[function(require,module,exports){
var m=require("mithril"),sugartags=require("../server/mithril.sugartags.node.js")(m);module.exports.index={controller:function(){return this.installButton="Install miso now",this.installButtonLink="#install",this.introText="Create tiny efficient isomorphic JS apps in a snap!",this},view:function(ctrl){with(sugartags)return DIV([DIV({"class":"intro"},[DIV({"class":"introText"},ctrl.introText),BUTTON({"class":"installButton"},ctrl.installButton)]),DIV({"class":"box"},[H2(A({name:"installation","class":"heading"},"Installation")),P("To install miso, use npm:"),PRE({"class":"javascript"},[CODE("npm install misojs -g")])]),DIV({"class":"box"},[H2(A({name:"gettingstarted","class":"heading"},"Getting started")),P("To create and run a new app in the current directory:"),PRE({"class":"javascript"},[CODE("miso -n myApp\ncd myApp && npm install\nmiso run")]),P("Congratulations, you are now running your very own miso app!")]),DIV({"class":"box"},[UL([LI(A({href:"/user/1",config:m.route},"User edit example")),LI(A({href:"/todos",config:m.route},"Todos example"))])])])}};
},{"../server/mithril.sugartags.node.js":10,"mithril":6}],4:[function(require,module,exports){
var m=require("mithril"),miso=require("../server/miso.util.js"),store=require("../server/store.js")(this),bindings=require("../server/mithril.bindings.node.js")(m);module.exports.index={models:{todo:function(e){this.text=e.text,this.done=m.p(e.done)}},controller:function(){var e=this;return e.vm={todoList:function(e){this.todos=m.p(e)},left:function(){var o=0;return e.model.todos().map(function(e){o+=e.done()?0:1}),o},input:m.p("")},e.addTodo=function(o){var t=e.vm.input();if(t){var n=new module.exports.index.models.todo({text:e.vm.input(),done:!1});e.model.todos.push(n),e.vm.input(""),store.save("todo.index.models.todo",n).then(function(e){console.log(e.result?e.result:e.error)})}return o.preventDefault(),!1},e.archive=function(){var o=[];e.model.todos().map(function(e){e.done()||o.push(e)}),e.model.todos(o)},store.load("todo",1).then(function(){e.model=new e.vm.todoList([new module.exports.index.models.todo({text:"learn mithril",done:!0}),new module.exports.index.models.todo({text:"build a mithril app",done:!1})])}),e},view:function(e){var o=e,t=o.model;return[m.e("style",".done{text-decoration: line-through;}"),m.e("h1","Todos - "+o.vm.left()+" of "+t.todos().length+" remaining"),m.e("button",{onclick:o.archive},"Archive"),m.e("ul",[t.todos().map(function(e){return m.e("li",{"class":e.done()?"done":"",toggle:e.done},e.text)})]),m.e("form",{onsubmit:o.addTodo},[m.e("input",{type:"text",value:o.vm.input,placeholder:"Add todo"}),m.e("button",{type:"submit"},"Add")])]}};
},{"../server/miso.util.js":1,"../server/mithril.bindings.node.js":9,"../server/store.js":2,"mithril":6}],5:[function(require,module,exports){
var store=require("../server/store.js")(this),miso=require("../server/miso.util.js"),validate=require("validator.modelbinder"),m=require("mithril"),sugartags=require("../server/mithril.sugartags.node.js")(m),bindings=require("../server/mithril.bindings.node.js")(m);module.exports.index={controller:function(){var e=this;return this.users=[],store.load("user",1).then(function(i){e.users=i}),e},view:function(ctrl){with(sugartags)return DIV("All the users would be listed here")}},module.exports.edit={models:{user:function(e){return this.name=m.p(e.name),this.email=m.p(e.email),this.id=m.p(e.id),this.isValid=validate.bind(this,{name:{isRequired:"You must enter a name"},email:{isRequired:"You must enter an email address",isEmail:"Must be a valid email address"}}),this}},controller:function(e){var i=this,s=miso.getParam("user_id",e);return store.load("user",s).then(function(e){e.email="is_email.com",i.user=new module.exports.edit.models.user(e)}),i.save=function(){store.save("user.edit.models.user",i.user).then(function(e){console.log(e.result?e.result:e.error)})},i},view:function(ctrl){with(sugartags)return[H2({"class":"pageHeader"},"Edit user"),DIV([LABEL("Name"),INPUT({value:ctrl.user.name}),DIV({"class":1==ctrl.user.isValid("name")?"valid":"invalid"},[1==ctrl.user.isValid("name")?"":ctrl.user.isValid("name").join(", ")])]),DIV([LABEL("Email"),INPUT({value:ctrl.user.email}),DIV({"class":(1==ctrl.user.isValid("email")?"valid":"invalid")+" indented"},[1==ctrl.user.isValid("email")?"":ctrl.user.isValid("email").join(", ")])]),DIV({"class":"indented"},[BUTTON({onclick:ctrl.save,"class":"positive"},"Save user")])]}};
},{"../server/miso.util.js":1,"../server/mithril.bindings.node.js":9,"../server/mithril.sugartags.node.js":10,"../server/store.js":2,"mithril":6,"validator.modelbinder":7}],6:[function(require,module,exports){
var m=function e(t,n){function r(e){A=e.document,S=e.location,R=e.cancelAnimationFrame||e.clearTimeout,M=e.requestAnimationFrame||e.setTimeout}function o(){var e,t=[].slice.call(arguments),n=!(null==t[1]||z.call(t[1])!==B||"tag"in t[1]||"subtree"in t[1]),r=n?t[1]:{},o="class"in r?"class":"className",a={tag:"div",attrs:{}},i=[];if(z.call(t[0])!=D)throw new Error("selector in m(selector, attrs, children) should be a string");for(;e=H.exec(t[0]);)if(""===e[1]&&e[2])a.tag=e[2];else if("#"===e[1])a.attrs.id=e[2];else if("."===e[1])i.push(e[2]);else if("["===e[3][0]){var l=I.exec(e[3]);a.attrs[l[1]]=l[3]||(l[2]?"":!0)}i.length>0&&(a.attrs[o]=i.join(" "));var s=n?t[2]:t[1];a.children=z.call(s)===L?s:t.slice(n?2:1);for(var u in r)a.attrs[u]=u===o?(a.attrs[u]||"")+" "+r[u]:r[u];return a}function a(e,t,r,o,u,d,f,h,g,m,p){if((null==u||null==u.toString())&&(u=""),"retain"===u.subtree)return d;var v=z.call(d),y=z.call(u);if(null==d||v!==y){if(null!=d)if(r&&r.nodes){var w=h-o,x=w+(y===L?u:d.nodes).length;s(r.nodes.slice(w,x),r.slice(w,x))}else d.nodes&&s(d.nodes,d);d=new u.constructor,d.tag&&(d={}),d.nodes=[]}if(y===L){for(var N=0,b=u.length;b>N;N++)z.call(u[N])===L&&(u=u.concat.apply([],u),N--);for(var E=[],C=d.length===u.length,T=0,O=1,j=2,k=3,S={},M=[],R=!1,N=0;N<d.length;N++)d[N]&&d[N].attrs&&null!=d[N].attrs.key&&(R=!0,S[d[N].attrs.key]={action:O,index:N});if(R){u.indexOf(null)>-1&&(u=u.filter(function(e){return null!=e}));var H=!1;if(u.length!=d.length)H=!0;else for(var I,K,N=0;I=d[N],K=u[N];N++)if(I.attrs&&K.attrs&&I.attrs.key!=K.attrs.key){H=!0;break}if(H){for(var N=0,b=u.length;b>N;N++)if(u[N]&&u[N].attrs)if(null!=u[N].attrs.key){var U=u[N].attrs.key;S[U]=S[U]?{action:k,index:N,from:S[U].index,element:e.childNodes[S[U].index]||A.createElement("div")}:{action:j,index:N}}else M.push({index:N,element:e.childNodes[N]||A.createElement("div")});var $=[];for(var F in S)$.push(S[F]);for(var G,P=$.sort(i),V=new Array(d.length),N=0;G=P[N];N++){if(G.action===O&&(s(d[G.index].nodes,d[G.index]),V.splice(G.index,1)),G.action===j){var _=A.createElement("div");_.key=u[G.index].attrs.key,e.insertBefore(_,e.childNodes[G.index]||null),V.splice(G.index,0,{attrs:{key:u[G.index].attrs.key},nodes:[_]})}G.action===k&&(e.childNodes[G.index]!==G.element&&null!==G.element&&e.insertBefore(G.element,e.childNodes[G.index]||null),V[G.index]=d[G.from])}for(var N=0,b=M.length;b>N;N++){var G=M[N];e.insertBefore(G.element,e.childNodes[G.index]||null),V[G.index]=d[G.index]}d=V,d.nodes=new Array(e.childNodes.length);for(var Y,N=0;Y=e.childNodes[N];N++)d.nodes[N]=Y}}for(var N=0,W=0,b=u.length;b>N;N++){var X=a(e,t,d,h,u[N],d[W],f,h+T||T,g,m,p);X!==n&&(X.nodes.intact||(C=!1),T+=X.$trusted?(X.match(/<[^\/]|\>\s*[^<]/g)||[]).length:z.call(X)===L?X.length:1,d[W++]=X)}if(!C){for(var N=0,b=u.length;b>N;N++)null!=d[N]&&E.push.apply(E,d[N].nodes);for(var Q,N=0;Q=d.nodes[N];N++)null!=Q.parentNode&&E.indexOf(Q)<0&&s([Q],[d[N]]);u.length<d.length&&(d.length=u.length),d.nodes=E}}else if(null!=u&&y===B){u.attrs||(u.attrs={}),d.attrs||(d.attrs={});var Z=Object.keys(u.attrs),et=Z.length>("key"in u.attrs?1:0);if((u.tag!=d.tag||Z.join()!=Object.keys(d.attrs).join()||u.attrs.id!=d.attrs.id)&&(d.nodes.length&&s(d.nodes),d.configContext&&typeof d.configContext.onunload===q&&d.configContext.onunload()),z.call(u.tag)!=D)return;var Q,tt=0===d.nodes.length;if(u.attrs.xmlns?m=u.attrs.xmlns:"svg"===u.tag?m="http://www.w3.org/2000/svg":"math"===u.tag&&(m="http://www.w3.org/1998/Math/MathML"),tt?(Q=u.attrs.is?m===n?A.createElement(u.tag,u.attrs.is):A.createElementNS(m,u.tag,u.attrs.is):m===n?A.createElement(u.tag):A.createElementNS(m,u.tag),d={tag:u.tag,attrs:et?l(Q,u.tag,u.attrs,{},m):u.attrs,children:null!=u.children&&u.children.length>0?a(Q,u.tag,n,n,u.children,d.children,!0,0,u.attrs.contenteditable?Q:g,m,p):u.children,nodes:[Q]},d.children&&!d.children.nodes&&(d.children.nodes=[]),"select"===u.tag&&u.attrs.value&&l(Q,u.tag,{value:u.attrs.value},{},m),e.insertBefore(Q,e.childNodes[h]||null)):(Q=d.nodes[0],et&&l(Q,u.tag,u.attrs,d.attrs,m),d.children=a(Q,u.tag,n,n,u.children,d.children,!1,0,u.attrs.contenteditable?Q:g,m,p),d.nodes.intact=!0,f===!0&&null!=Q&&e.insertBefore(Q,e.childNodes[h]||null)),typeof u.attrs.config===q){var nt=d.configContext=d.configContext||{},rt=function(e,t){return function(){return e.attrs.config.apply(e,t)}};p.push(rt(u,[Q,!tt,nt,d]))}}else if(typeof y!=q){var E;0===d.nodes.length?(u.$trusted?E=c(e,h,u):(E=[A.createTextNode(u)],e.nodeName.match(J)||e.insertBefore(E[0],e.childNodes[h]||null)),d="string number boolean".indexOf(typeof u)>-1?new u.constructor(u):u,d.nodes=E):d.valueOf()!==u.valueOf()||f===!0?(E=d.nodes,g&&g===A.activeElement||(u.$trusted?(s(E,d),E=c(e,h,u)):"textarea"===t?e.value=u:g?g.innerHTML=u:((1===E[0].nodeType||E.length>1)&&(s(d.nodes,d),E=[A.createTextNode(u)]),e.insertBefore(E[0],e.childNodes[h]||null),E[0].nodeValue=u)),d=new u.constructor(u),d.nodes=E):d.nodes.intact=!0}return d}function i(e,t){return e.action-t.action||e.index-t.index}function l(e,t,n,r,o){for(var a in n){var i=n[a],l=r[a];if(a in r&&l===i)"value"===a&&"input"===t&&e.value!=i&&(e.value=i);else{r[a]=i;try{if("config"===a||"key"==a)continue;if(typeof i===q&&0===a.indexOf("on"))e[a]=d(i,e);else if("style"===a&&null!=i&&z.call(i)===B){for(var s in i)(null==l||l[s]!==i[s])&&(e.style[s]=i[s]);for(var s in l)s in i||(e.style[s]="")}else null!=o?"href"===a?e.setAttributeNS("http://www.w3.org/1999/xlink","href",i):"className"===a?e.setAttribute("class",i):e.setAttribute(a,i):a in e&&"list"!==a&&"style"!==a&&"form"!==a&&"type"!==a?("input"!==t||e[a]!==i)&&(e[a]=i):e.setAttribute(a,i)}catch(u){if(u.message.indexOf("Invalid argument")<0)throw u}}}return r}function s(e,t){for(var n=e.length-1;n>-1;n--)if(e[n]&&e[n].parentNode){try{e[n].parentNode.removeChild(e[n])}catch(r){}t=[].concat(t),t[n]&&u(t[n])}0!=e.length&&(e.length=0)}function u(e){if(e.configContext&&typeof e.configContext.onunload===q&&e.configContext.onunload(),e.children)if(z.call(e.children)===L)for(var t,n=0;t=e.children[n];n++)u(t);else e.children.tag&&u(e.children)}function c(e,t,n){var r=e.childNodes[t];if(r){var o=1!=r.nodeType,a=A.createElement("span");o?(e.insertBefore(a,r||null),a.insertAdjacentHTML("beforebegin",n),e.removeChild(a)):r.insertAdjacentHTML("beforebegin",n)}else e.insertAdjacentHTML("beforeend",n);for(var i=[];e.childNodes[t]!==r;)i.push(e.childNodes[t]),t++;return i}function d(e,t){return function(n){n=n||event,o.redraw.strategy("diff"),o.startComputation();try{return e.call(t,n)}finally{et()}}}function f(e){var t=$.indexOf(e);return 0>t?$.push(e)-1:t}function h(e){var t=function(){return arguments.length&&(e=arguments[0]),e};return t.toJSON=function(){return e},t}function g(){for(var e,t="all"===o.redraw.strategy(),n=0;e=P[n];n++)_[n]&&o.render(e,V[n].view(_[n]),t);X&&(X(),X=null),Y=null,W=new Date,o.redraw.strategy("diff")}function m(e){return e.slice(rt[o.route.mode].length)}function p(e,t,n){tt={};var r=n.indexOf("?");-1!==r&&(tt=x(n.substr(r+1,n.length)),n=n.substr(0,r));for(var a in t){if(a===n)return o.module(e,t[a]),!0;var i=new RegExp("^"+a.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(i.test(n))return n.replace(i,function(){for(var n=a.match(/:[^\/]+/g)||[],r=[].slice.call(arguments,1,-2),i=0,l=n.length;l>i;i++)tt[n[i].replace(/:|\./g,"")]=decodeURIComponent(r[i]);o.module(e,t[a])}),!0}}function v(e){if(e=e||event,!e.ctrlKey&&!e.metaKey&&2!==e.which){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=e.currentTarget||this,n="pathname"===o.route.mode&&t.search?x(t.search.slice(1)):{};o.route(t[o.route.mode].slice(rt[o.route.mode].length),n)}}function y(){"hash"!=o.route.mode&&S.hash?S.hash=S.hash:t.scrollTo(0,0)}function w(e,t){var n=[];for(var r in e){var o=t?t+"["+r+"]":r,a=e[r];n.push(null!=a&&z.call(a)===B?w(a,o):encodeURIComponent(o)+"="+encodeURIComponent(a))}return n.join("&")}function x(e){for(var t=e.split("&"),n={},r=0,o=t.length;o>r;r++){var a=t[r].split("=");n[N(a[0])]=a[1]?N(a[1]):""}return n}function N(e){return decodeURIComponent(e.replace(/\+/g," "))}function b(e){var t=f(e);s(e.childNodes,F[t]),F[t]=n}function E(e){var t=o.prop();return e.then(t),t.then=function(t,n){return E(e.then(t,n))},t}function C(e,t){function n(e){d=e||u,h.map(function(e){d===s&&e.resolve(f)||e.reject(f)})}function r(e,t,n,r){if((null!=f&&z.call(f)===B||typeof f===q)&&typeof e===q)try{var a=0;e.call(f,function(e){a++||(f=e,t())},function(e){a++||(f=e,n())})}catch(i){o.deferred.onerror(i),f=i,n()}else r()}function a(){var u;try{u=f&&f.then}catch(h){return o.deferred.onerror(h),f=h,d=l,a()}r(u,function(){d=i,a()},function(){d=l,a()},function(){try{d===i&&typeof e===q?f=e(f):d===l&&"function"==typeof t&&(f=t(f),d=i)}catch(a){return o.deferred.onerror(a),f=a,n()}f===c?(f=TypeError(),n()):r(u,function(){n(s)},n,function(){n(d===i&&s)})})}var i=1,l=2,s=3,u=4,c=this,d=0,f=0,h=[];c.promise={},c.resolve=function(e){return d||(f=e,d=i,a()),this},c.reject=function(e){return d||(f=e,d=l,a()),this},c.promise.then=function(e,t){var n=new C(e,t);return d===s?n.resolve(f):d===u?n.reject(f):h.push(n),n.promise}}function T(e){return e}function O(e){if(!e.dataType||"jsonp"!==e.dataType.toLowerCase()){var r=new t.XMLHttpRequest;if(r.open(e.method,e.url,!0,e.user,e.password),r.onreadystatechange=function(){4===r.readyState&&(r.status>=200&&r.status<300?e.onload({type:"load",target:r}):e.onerror({type:"error",target:r}))},e.serialize===JSON.stringify&&e.data&&"GET"!==e.method&&r.setRequestHeader("Content-Type","application/json; charset=utf-8"),e.deserialize===JSON.parse&&r.setRequestHeader("Accept","application/json, text/*"),typeof e.config===q){var o=e.config(r,e);null!=o&&(r=o)}var a="GET"!==e.method&&e.data?e.data:"";if(a&&z.call(a)!=D&&a.constructor!=t.FormData)throw"Request data should be either be a string or FormData. Check the `serialize` option in `m.request`";return r.send(a),r}var i="mithril_callback_"+(new Date).getTime()+"_"+Math.round(1e16*Math.random()).toString(36),l=A.createElement("script");t[i]=function(r){A.body.removeChild(l),e.onload({type:"load",target:{responseText:r}}),t[i]=n},l.onerror=function(){return A.body.removeChild(l),e.onerror({type:"error",target:{status:500,responseText:JSON.stringify({error:"Error making jsonp request"})}}),t[i]=n,!1},l.onload=function(){return!1},l.src=e.url+(e.url.indexOf("?")>0?"&":"?")+(e.callbackKey?e.callbackKey:"callback")+"="+i+"&"+w(e.data||{}),A.body.appendChild(l)}function j(e,t,n){if("GET"===e.method&&"jsonp"!=e.dataType){var r=e.url.indexOf("?")<0?"?":"&",o=w(t);e.url=e.url+(o?r+o:"")}else e.data=n(t);return e}function k(e,t){var n=e.match(/:[a-z]\w+/gi);if(n&&t)for(var r=0;r<n.length;r++){var o=n[r].slice(1);e=e.replace(n[r],t[o]),delete t[o]}return e}var A,S,M,R,B="[object Object]",L="[object Array]",D="[object String]",q="function",z={}.toString,H=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,I=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/,J=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/;r(t);var K,U={appendChild:function(e){K===n&&(K=A.createElement("html")),A.documentElement&&A.documentElement!==e?A.replaceChild(e,A.documentElement):A.appendChild(e),this.childNodes=A.childNodes},insertBefore:function(e){this.appendChild(e)},childNodes:[]},$=[],F={};o.render=function(e,t,r){var o=[];if(!e)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var i=f(e),l=e===A,u=l||e===A.documentElement?U:e;l&&"html"!=t.tag&&(t={tag:"html",attrs:{},children:t}),F[i]===n&&s(u.childNodes),r===!0&&b(e),F[i]=a(u,null,n,n,t,F[i],!1,0,null,n,o);for(var c=0,d=o.length;d>c;c++)o[c]()},o.trust=function(e){return e=new String(e),e.$trusted=!0,e},o.prop=function(e){return(null!=e&&z.call(e)===B||typeof e===q)&&typeof e.then===q?E(e):h(e)};var G,P=[],V=[],_=[],Y=null,W=0,X=null,Q=16;o.module=function(e,t){if(!e)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var n=P.indexOf(e);0>n&&(n=P.length);var r=!1;if(_[n]&&typeof _[n].onunload===q){var a={preventDefault:function(){r=!0}};_[n].onunload(a)}if(!r){o.redraw.strategy("all"),o.startComputation(),P[n]=e;var i=G=t,l=new t.controller;return i===G&&(_[n]=l,V[n]=t),et(),_[n]}},o.redraw=function(e){Y&&e!==!0?(new Date-W>Q||M===t.requestAnimationFrame)&&(Y>0&&R(Y),Y=M(g,Q)):(g(),Y=M(function(){Y=null},Q))},o.redraw.strategy=o.prop();var Z=0;o.startComputation=function(){Z++},o.endComputation=function(){Z=Math.max(Z-1,0),0===Z&&o.redraw()};var et=function(){"none"==o.redraw.strategy()?(Z--,o.redraw.strategy("diff")):o.endComputation()};o.withAttr=function(e,t){return function(n){n=n||event;var r=n.currentTarget||this;t(e in r?r[e]:r.getAttribute(e))}};var tt,nt,rt={pathname:"",hash:"#",search:"?"},ot=function(){};return o.route=function(){if(0===arguments.length)return nt;if(3===arguments.length&&z.call(arguments[1])===D){var e=arguments[0],n=arguments[1],r=arguments[2];ot=function(t){var a=nt=m(t);p(e,r,a)||o.route(n,!0)};var a="hash"===o.route.mode?"onhashchange":"onpopstate";t[a]=function(){nt!=m(S[o.route.mode])&&ot(S[o.route.mode])},X=y,t[a]()}else if(arguments[0].addEventListener){{var i=arguments[0];arguments[1],arguments[2]}i.href=("pathname"!==o.route.mode?S.pathname:"")+rt[o.route.mode]+this.attrs.href,i.removeEventListener("click",v),i.addEventListener("click",v)}else if(z.call(arguments[0])===D){nt=arguments[0];var l=arguments[1]||{},s=nt.indexOf("?"),u=s>-1?x(nt.slice(s+1)):{};for(var c in l)u[c]=l[c];var d=w(u),f=s>-1?nt.slice(0,s):nt;d&&(nt=f+(-1===f.indexOf("?")?"?":"&")+d);var h=(3===arguments.length?arguments[2]:arguments[1])===!0;t.history.pushState?(X=function(){t.history[h?"replaceState":"pushState"](null,A.title,rt[o.route.mode]+nt),y()},ot(rt[o.route.mode]+nt)):S[o.route.mode]=nt}},o.route.param=function(e){if(!tt)throw new Error("You must call m.route(element, defaultRoute, routes) before calling m.route.param()");return tt[e]},o.route.mode="search",o.deferred=function(){var e=new C;return e.promise=E(e.promise),e},o.deferred.onerror=function(e){if("[object Error]"===z.call(e)&&!e.constructor.toString().match(/ Error/))throw e},o.sync=function(e){function t(e,t){return function(o){return i[e]=o,t||(n="reject"),0===--a&&(r.promise(i),r[n](i)),o}}var n="resolve",r=o.deferred(),a=e.length,i=new Array(a);if(e.length>0)for(var l=0;l<e.length;l++)e[l].then(t(l,!0),t(l,!1));else r.resolve([]);return r.promise},o.request=function(e){e.background!==!0&&o.startComputation();var t=o.deferred(),n=e.dataType&&"jsonp"===e.dataType.toLowerCase(),r=e.serialize=n?T:e.serialize||JSON.stringify,a=e.deserialize=n?T:e.deserialize||JSON.parse,i=e.extract||function(e){return 0===e.responseText.length&&a===JSON.parse?null:e.responseText};return e.url=k(e.url,e.data),e=j(e,e.data,r),e.onload=e.onerror=function(n){try{n=n||event;var r=("load"===n.type?e.unwrapSuccess:e.unwrapError)||T,l=r(a(i(n.target,e)));if("load"===n.type)if(z.call(l)===L&&e.type)for(var s=0;s<l.length;s++)l[s]=new e.type(l[s]);else e.type&&(l=new e.type(l));t["load"===n.type?"resolve":"reject"](l)}catch(n){o.deferred.onerror(n),t.reject(n)}e.background!==!0&&o.endComputation()},O(e),t.promise(e.initialValue),t.promise},o.deps=function(e){return r(t=e||t),t},o.deps.factory=e,o}("undefined"!=typeof window?window:{});"undefined"!=typeof module&&null!==module&&module.exports?module.exports=m:"function"==typeof define&&define.amd&&define(function(){return m});
},{}],7:[function(require,module,exports){
var validator=require("validator");module.exports={bind:function(n,r){return function(e){var i,u={},t=!1,o=function(n){return"undefined"!=typeof n&&""!==n&&null!==n},f=function(r){return"function"==typeof n[r]?n[r]():n[r]},d=function(n,r,e){var i,u,t=[];for(i in e)u="isRequired"==i?o(r)?!0:e[i]:validator[i](r)?!0:e[i],u!==!0?(t=t===!0||"undefined"==t?[]:t,t.push(u)):t=!0;return t};if(e)u=d(e,f(e),r[e]);else{for(e in r)i=d(e,f(e),r[e]),i!==!0&&(t=!0),u[e]=i;t||(u=!0)}return u}}};
},{"validator":8}],8:[function(require,module,exports){
!function(t,e){"undefined"!=typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&"object"==typeof define.amd?define(e):this[t]=e()}("validator",function(t){"use strict";function e(t,e){t=t||{};for(var n in e)"undefined"==typeof t[n]&&(t[n]=e[n]);return t}t={version:"3.27.0"};var n=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,r=/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,i=/^(?:[0-9]{9}X|[0-9]{10})$/,u=/^(?:[0-9]{13})$/,o=/^(\d?\d?\d)\.(\d?\d?\d)\.(\d?\d?\d)\.(\d?\d?\d)$/,F=/^::|^::1|^([a-fA-F0-9]{1,4}::?){1,7}([a-fA-F0-9]{1,4})$/,a={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i},s=/^[a-zA-Z]+$/,f=/^[a-zA-Z0-9]+$/,l=/^-?[0-9]+$/,c=/^(?:-?(?:0|[1-9][0-9]*))$/,p=/^(?:-?(?:[0-9]+))?(?:\.[0-9]*)?(?:[eE][\+\-]?(?:[0-9]+))?$/,d=/^[0-9a-fA-F]+$/,g=/^#?([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,x=/^[\x00-\x7F]+$/,D=/[^\x00-\x7F]/,A=/[^\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/,h=/[\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/,$=/[\uD800-\uDBFF][\uDC00-\uDFFF]/,E=/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})$/,v={"zh-CN":/^(\+?0?86\-?)?1[345789][0-9]{9}$/,"en-ZA":/^(\+?27|0)(\d{9})$/,"en-AU":/^(\+?61|0)4(\d{8})/};t.extend=function(e,n){t[e]=function(){var e=Array.prototype.slice.call(arguments);return e[0]=t.toString(e[0]),n.apply(t,e)}},t.init=function(){for(var e in t)"function"==typeof t[e]&&"toString"!==e&&"toDate"!==e&&"extend"!==e&&"init"!==e&&t.extend(e,t[e])},t.toString=function(t){return"object"==typeof t&&null!==t&&t.toString?t=t.toString():null===t||"undefined"==typeof t||isNaN(t)&&!t.length?t="":"string"!=typeof t&&(t+=""),t},t.toDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)?t:(t=Date.parse(t),isNaN(t)?null:new Date(t))},t.toFloat=function(t){return parseFloat(t)},t.toInt=function(t,e){return parseInt(t,e||10)},t.toBoolean=function(t,e){return e?"1"===t||"true"===t:"0"!==t&&"false"!==t&&""!==t},t.equals=function(e,n){return e===t.toString(n)},t.contains=function(e,n){return e.indexOf(t.toString(n))>=0},t.matches=function(t,e,n){return"[object RegExp]"!==Object.prototype.toString.call(e)&&(e=new RegExp(e,n)),e.test(t)},t.isEmail=function(t){return n.test(t)};var w={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,allow_underscores:!1,allow_trailing_dot:!1};t.isURL=function(n,r){if(!n||n.length>=2083)return!1;if(0===n.indexOf("mailto:"))return!1;r=e(r,w);var i,u,o,F,a,s,f,l,c,p,d,g;if(g=n.split("://"),g.length>1){if(i=g.shift(),-1===r.protocols.indexOf(i))return!1}else if(r.require_protocol)return!1;if(n=g.join("://"),g=n.split("#"),n=g.shift(),d=g.join("#"),d&&/\s/.test(d))return!1;if(g=n.split("?"),n=g.shift(),p=g.join("?"),p&&/\s/.test(p))return!1;if(g=n.split("/"),n=g.shift(),c=g.join("/"),c&&/\s/.test(c))return!1;if(g=n.split("@"),g.length>1&&(F=g.shift(),F.indexOf(":")>=0)){if(F=F.split(":"),u=F.shift(),!/^\S+$/.test(u))return!1;if(o=F.join(":"),!/^\S*$/.test(u))return!1}return s=g.join("@"),g=s.split(":"),a=g.shift(),g.length&&(l=g.join(":"),f=parseInt(l,10),!/^[0-9]+$/.test(l)||0>=f||f>65535)?!1:t.isIP(a)||t.isFQDN(a,r)||"localhost"===a?r.host_whitelist&&-1===r.host_whitelist.indexOf(a)?!1:r.host_blacklist&&-1!==r.host_blacklist.indexOf(a)?!1:!0:!1},t.isIP=function(e,n){if(n=t.toString(n),!n)return t.isIP(e,4)||t.isIP(e,6);if("4"===n){if(!o.test(e))return!1;var r=e.split(".").sort(function(t,e){return t-e});return r[3]<=255}return"6"===n&&F.test(e)};var m={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1};t.isFQDN=function(t,n){n=e(n,m),n.allow_trailing_dot&&"."===t[t.length-1]&&(t=t.substring(0,t.length-1));var r=t.split(".");if(n.require_tld){var i=r.pop();if(!r.length||!/^[a-z]{2,}$/i.test(i))return!1}for(var u,o=0;o<r.length;o++){if(u=r[o],n.allow_underscores){if(u.indexOf("__")>=0)return!1;u=u.replace(/_/g,"")}if(!/^[a-z\u00a1-\uffff0-9-]+$/i.test(u))return!1;if("-"===u[0]||"-"===u[u.length-1]||u.indexOf("---")>=0)return!1}return!0},t.isAlpha=function(t){return s.test(t)},t.isAlphanumeric=function(t){return f.test(t)},t.isNumeric=function(t){return l.test(t)},t.isHexadecimal=function(t){return d.test(t)},t.isHexColor=function(t){return g.test(t)},t.isLowercase=function(t){return t===t.toLowerCase()},t.isUppercase=function(t){return t===t.toUpperCase()},t.isInt=function(t){return c.test(t)},t.isFloat=function(t){return""!==t&&p.test(t)},t.isDivisibleBy=function(e,n){return t.toFloat(e)%t.toInt(n)===0},t.isNull=function(t){return 0===t.length},t.isLength=function(t,e,n){var r=t.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g)||[],i=t.length-r.length;return i>=e&&("undefined"==typeof n||n>=i)},t.isByteLength=function(t,e,n){return t.length>=e&&("undefined"==typeof n||t.length<=n)},t.isUUID=function(t,e){var n=a[e?e:"all"];return n&&n.test(t)},t.isDate=function(t){return!isNaN(Date.parse(t))},t.isAfter=function(e,n){var r=t.toDate(n||new Date),i=t.toDate(e);return!!(i&&r&&i>r)},t.isBefore=function(e,n){var r=t.toDate(n||new Date),i=t.toDate(e);return i&&r&&r>i},t.isIn=function(e,n){var r;if("[object Array]"===Object.prototype.toString.call(n)){var i=[];for(r in n)i[r]=t.toString(n[r]);return i.indexOf(e)>=0}return"object"==typeof n?n.hasOwnProperty(e):n&&"function"==typeof n.indexOf?n.indexOf(e)>=0:!1},t.isCreditCard=function(t){var e=t.replace(/[^0-9]+/g,"");if(!r.test(e))return!1;for(var n,i,u,o=0,F=e.length-1;F>=0;F--)n=e.substring(F,F+1),i=parseInt(n,10),u?(i*=2,o+=i>=10?i%10+1:i):o+=i,u=!u;return!!(o%10===0?e:!1)},t.isISBN=function(e,n){if(n=t.toString(n),!n)return t.isISBN(e,10)||t.isISBN(e,13);var r,o=e.replace(/[\s-]+/g,""),F=0;if("10"===n){if(!i.test(o))return!1;for(r=0;9>r;r++)F+=(r+1)*o.charAt(r);if(F+="X"===o.charAt(9)?100:10*o.charAt(9),F%11===0)return!!o}else if("13"===n){if(!u.test(o))return!1;var a=[1,3];for(r=0;12>r;r++)F+=a[r%2]*o.charAt(r);if(o.charAt(12)-(10-F%10)%10===0)return!!o}return!1},t.isMobilePhone=function(t,e){return e in v?v[e].test(t):!1},t.isJSON=function(t){try{JSON.parse(t)}catch(e){return!1}return!0},t.isMultibyte=function(t){return D.test(t)},t.isAscii=function(t){return x.test(t)},t.isFullWidth=function(t){return A.test(t)},t.isHalfWidth=function(t){return h.test(t)},t.isVariableWidth=function(t){return A.test(t)&&h.test(t)},t.isSurrogatePair=function(t){return $.test(t)},t.isBase64=function(t){return E.test(t)},t.isMongoId=function(e){return t.isHexadecimal(e)&&24===e.length},t.ltrim=function(t,e){var n=e?new RegExp("^["+e+"]+","g"):/^\s+/g;return t.replace(n,"")},t.rtrim=function(t,e){var n=e?new RegExp("["+e+"]+$","g"):/\s+$/g;return t.replace(n,"")},t.trim=function(t,e){var n=e?new RegExp("^["+e+"]+|["+e+"]+$","g"):/^\s+|\s+$/g;return t.replace(n,"")},t.escape=function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2F;")},t.stripLow=function(e,n){var r=n?"\x00-	\f-":"\x00-";return t.blacklist(e,r)},t.whitelist=function(t,e){return t.replace(new RegExp("[^"+e+"]+","g"),"")},t.blacklist=function(t,e){return t.replace(new RegExp("["+e+"]+","g"),"")};var y={lowercase:!0};return t.normalizeEmail=function(n,r){if(r=e(r,y),!t.isEmail(n))return!1;var i=n.split("@",2);return i[1]=i[1].toLowerCase(),r.lowercase&&(i[0]=i[0].toLowerCase()),("gmail.com"===i[1]||"googlemail.com"===i[1])&&(r.lowercase||(i[0]=i[0].toLowerCase()),i[0]=i[0].replace(/\./g,"").split("+")[0],i[1]="gmail.com"),i.join("@")},t.init(),t});
},{}],9:[function(require,module,exports){
!function(){var n=function(n){n.bindings=n.bindings||{},n.p=function(e){var t,i=this,u=[],o=!1,r=function(n,e){var t;for(t=0;t<u.length;t+=1)u[t].func.apply(u[t].context,[n,e])},f=function(){if(arguments.length&&(e=arguments[0],t!==e)){var n=t;t=e,r(e,n)}return e};return f.push=function(n){e.push&&"undefined"!=typeof e.length&&e.push(n),f(e)},f.subscribe=function(n,e){return u.push({func:n,context:e||i}),f},f.delay=function(n){return o=!!n,f},f.subscribe(function(){return o||(n.startComputation(),n.endComputation()),f}),f},n.e=function(e,t,i){for(var u in t)n.bindings[u]&&(n.bindings[u].func.apply(t,[t[u]]),n.bindings[u].removeable&&delete t[u]);return n(e,t,i)},n.addBinding=function(e,t,i){n.bindings[e]={func:t,removeable:i}},n.unwrap=function(n){return"function"==typeof n?n():n},n.addBinding("value",function(e){"function"==typeof e?(this.value=e(),this.onchange=n.withAttr("value",e)):this.value=e}),n.addBinding("checked",function(e){"function"==typeof e?(this.checked=e(),this.onchange=n.withAttr("checked",e)):this.checked=e}),n.addBinding("hide",function(e){this.style={display:n.unwrap(e)?"none":""}},!0),n.addBinding("toggle",function(n){this.onclick=function(){var e,t,i,u,o="function"==typeof n,r=[];if(o)value=n(),n(!value);else{for(e=n[0],i=e(),r=n.slice(1),u=r[0],t=0;t<r.length;t+=1)if(i==r[t]){"undefined"!=typeof r[t+1]&&(u=r[t+1]);break}e(u)}}},!0),n.addBinding("hover",function(n){this.onmouseover=n[0],n[1]&&(this.onmouseout=n[1])},!0);for(var e=["Input","Keyup","Keypress"],t=function(e,t){n.addBinding(e,function(e){"function"==typeof e?(this.value=e(),this[t]=n.withAttr("value",e)):this.value=e},!0)},i=0;i<e.length;i+=1){var u=e[i];t("value"+u,"on"+u.toLowerCase())}return n.set=function(n,e){return function(){n(e)}},n.trigger=function(){var e=Array.prototype.slice.call(arguments);return function(){var t=e[0],i=e.slice(1);n.bindings[t]&&n.bindings[t].func.apply(this,i)}},n.bindings};"undefined"!=typeof module&&null!==module&&module.exports?module.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):n("undefined"!=typeof window?window.m||{}:{})}();
},{}],10:[function(require,module,exports){
module.exports=function(T){var E,A=function(T,E){var A;for(A in E)E.hasOwnProperty(A)&&T.push(E[A]);return T},O=["A","ABBR","ACRONYM","ADDRESS","AREA","ARTICLE","ASIDE","AUDIO","B","BDI","BDO","BIG","BLOCKQUOTE","BODY","BR","BUTTON","CANVAS","CAPTION","CITE","CODE","COL","COLGROUP","COMMAND","DATALIST","DD","DEL","DETAILS","DFN","DIV","DL","DT","EM","EMBED","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HEAD","HEADER","HGROUP","HR","HTML","I","IFRAME","IMG","INPUT","INS","KBD","KEYGEN","LABEL","LEGEND","LI","LINK","MAP","MARK","META","METER","NAV","NOSCRIPT","OBJECT","OL","OPTGROUP","OPTION","OUTPUT","P","PARAM","PRE","PROGRESS","Q","RP","RT","RUBY","SAMP","SCRIPT","SECTION","SELECT","SMALL","SOURCE","SPAN","SPLIT","STRONG","STYLE","SUB","SUMMARY","SUP","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TIME","TITLE","TR","TRACK","TT","UL","VAR","VIDEO","WBR"],R={};for(E in O)O.hasOwnProperty(E)&&!function(E){var O=E.toLowerCase();R[E]=function(){return(T.e?T.e:T).apply(this,A([O],arguments))}}(O[E]);return R};
},{}],11:[function(require,module,exports){
var m=require("mithril"),sugartags=require("../server/mithril.sugartags.node.js")(m),bindings=require("../server/mithril.bindings.node.js")(m),store=require("../server/store.js"),home=require("../mvc/home.js"),user=require("../mvc/user.js"),todo=require("../mvc/todo.js");"undefined"!=typeof window&&(window.m=m),m.route.mode="pathname",m.route(document.getElementById("misoAttachmentNode"),"/",{"/":home.index,"/user/:user_id":user.edit,"/todos":todo.index,"/users":user.index});
},{"../mvc/home.js":3,"../mvc/todo.js":4,"../mvc/user.js":5,"../server/mithril.bindings.node.js":9,"../server/mithril.sugartags.node.js":10,"../server/store.js":2,"mithril":6}]},{},[11])


//# sourceMappingURL=/miso.map.json